import numpy as np
import pandas as pd
from sklearn.metrics import mean_squared_error
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

## 読み込み
df_train = pd.read_csv("train.csv")

## 前処理
cols = ['GrLivArea','YearBuilt','OverallCond']
df_x = df_train[cols]
df_y = df_train["SalePrice"]

x_train, x_valid, y_train, y_valid = train_test_split(df_x, np.log(df_y), test_size=0.2)

## 予測
clf = LinearRegression()
clf.fit(x_train, y_train)

y_pred = clf.predict(x_valid)

print(mean_squared_error(y_pred, y_valid))
